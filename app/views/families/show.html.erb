<%= link_to tr('edit'), edit_family_path(@family) %> ::
<%= link_to tr('home'), {controller: :welcome, action: :index} %> ::
<%= link_to tr('community'), @community %>

<h1><%= tr('family') %></h1>

<p id="notice"><%= notice %></p>

<p>
  <strong><%= tr('community') %>:</strong>
  <%= link_to "#{@community.try(:code)}", @community %>
</p>

<p>
  <strong><%= tr('name') %>:</strong>
  <%= @family.name %>
</p>

<p>
  <strong><%= tr('notes') %>:</strong>
  <% if @family.notes.present? %>
  <pre><%= @family.notes %></pre>
  <% end %>
</p>
<br>

<h3><%= tr('guardians') %></h3>
<%= link_to tr('new'), {controller: :guardians, action: :new, family_id: @family.id} %>

<% if @guardians.present? %>
<table border=1 cellpadding=10>
  <thead>
    <tr>
      <th><%= tr('family_names') %></th>
      <th><%= tr('given_names') %></th>
      <th><%= tr('preferred_name') %></th>
      <th><%= tr('relationship') %></th>
      <th><%= tr('active') %></th>
      <th><%= tr('primary') %></th>
      <th><%= tr('phones') %></th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @guardians.each do |guardian| %>
      <tr>
        <td><%= guardian.family_name1 %> <%= guardian.family_name2 %></td>
        <td><%= guardian.given_name1 %> <%= guardian.given_name2 %></td>
        <td><%= guardian.preferred_name %></td>
        <td><%= Guardian::code_to_relationship(self)[guardian.relationship] %></td>
        <td><%= guardian.active ? tr('bool.true') : tr('bool.false') %></td>
        <td><%= guardian.primary ? tr('bool.true') : tr('bool.false') %></td>
        <td><%= guardian.primary_phone %> <%= guardian.secondary_phone %></td>
        <td><%= link_to tr('show'), guardian %></td>
      </tr>
    <% end %>
  </tbody>
</table>
<% end %>

<h3><%= tr("children") %></h3>
<%= link_to tr('new'), {controller: :children, action: :new, family_id: @family.id} %>

<% if @children.present? %>
<table>
  <thead>
    <tr>
      <th><%= tr('code') %></th>
      <th><%= tr('family_names') %></th>
      <th><%= tr('given_names') %></th>
      <th><%= tr('preferred_name') %></th>
      <th><%= tr('date_of_birth') %></th>
      <th><%= tr('status') %></th>
      <th><%= tr('gender') %></th>
      <th></th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @children.each do |child| %>
      <tr <%= child.status != "in_program" ? "class=out_of_program": "" %>>
        <td><%= child.code %></td>
        <td><%= child.family_name1 %> <%= child.family_name2 %></td>
        <td><%= child.given_name1 %> <%= child.given_name2 %></td>
        <td><%= child.preferred_name %></td>
        <td><%= child.dob %></td>
        <td class="status"><%= child.status == "in_program" ? "âœ“": "" %></td>
        <td><%= Child::code_to_gender(self)[child.gender] %></td>
        <td><%= link_to tr('show'), child %></td>
        <td><%= link_to tr('new_enrollment'), {controller: :enrollments, action: :new, child_id: child.id} %></td>
      </tr>
    <% end %>
  </tbody>
</table>
<% end %>

<h3><%= tr('family_years') %></h3>
<%= link_to tr('new'), {controller: :family_years, action: :new, family_id: @family.id} %>

<% if @family_years.present? %>
<table>
  <thead>
    <tr>
      <th><%= tr('school_year') %></th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @family_years.each do |family_year| %>
      <tr>
        <td><%= family_year.school_year %></td>
        <td><%= link_to tr('show'), family_year %></td>
      </tr>
    <% end %>
  </tbody>
</table>
<% end %>
